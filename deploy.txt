# MkDocs 项目部署到 GitHub Pages 指南

本指南详细介绍如何将当前 MkDocs 项目部署到 GitHub Pages。

## 1. 环境准备

### 1.1 安装必要工具

确保您的系统中已安装以下工具：
- Python 3.7+（推荐使用 3.9 或更高版本）
- Git
- MkDocs（已安装，用于本地开发）
- mkdocs-material 主题（如果使用）

### 1.2 配置 Git

```bash
# 配置用户名和邮箱
git config --global user.name "Your GitHub Username"
git config --global user.email "your.email@example.com"
```

## 2. GitHub 仓库准备

### 2.1 创建 GitHub 仓库

1. 登录 GitHub，点击右上角的 "+" 按钮，选择 "New repository"
2. 仓库名称建议使用 `yourusername.github.io`（用于个人主页）或任意名称（用于项目主页）
3. 选择公开仓库（Public）
4. 点击 "Create repository"

### 2.2 关联本地仓库

```bash
# 初始化 Git 仓库（如果尚未初始化）
git init

# 添加 GitHub 仓库为远程仓库
git remote add origin https://github.com/yourusername/your-repository-name.git

# 拉取远程仓库（如果远程仓库有内容）
git pull origin main
```

## 3. 项目配置调整

### 3.1 修改 mkdocs.yml 配置

编辑项目根目录下的 `mkdocs.yml` 文件，添加或修改以下配置：

```yaml
# 站点 URL - 替换为您的 GitHub Pages URL
site_url: https://yourusername.github.io/your-repository-name/

# 仓库 URL - 替换为您的 GitHub 仓库 URL
repo_url: https://github.com/yourusername/your-repository-name

# 部署配置
deploy:
  provider: github
  repo: yourusername/your-repository-name
  branch: gh-pages  # GitHub Pages 部署分支
  token: !ENV GH_TOKEN  # 可选：使用环境变量存储 GitHub Token
```

### 3.2 创建 .gitignore 文件

如果项目中没有 `.gitignore` 文件，创建一个并添加以下内容：

```
# MkDocs 构建输出
/site

# Python 缓存
__pycache__/
*.pyc

# 虚拟环境
venv/
env/

# 编辑器配置
.vscode/
.idea/
*.swp
*.swo

# 操作系统文件
.DS_Store
Thumbs.db

# 日志文件
*.log
```

## 4. 部署方式

### 4.1 方式一：使用 mkdocs gh-deploy 命令（推荐）

这是最简单的部署方式，MkDocs 会自动构建并部署到 GitHub Pages。

```bash
# 安装 mkdocs gh-deploy 依赖
pip install mkdocs-material  # 如果使用 Material 主题

# 构建并部署到 GitHub Pages
mkdocs gh-deploy
```

**执行结果说明：**
- 命令会在本地构建文档（生成 `site` 目录）
- 然后将构建好的文档推送到 GitHub 仓库的 `gh-pages` 分支
- GitHub 会自动从 `gh-pages` 分支部署您的网站

### 4.2 方式二：手动构建并部署

如果您想手动控制部署过程，可以使用以下步骤：

```bash
# 1. 构建文档
mkdocs build

# 2. 切换到 gh-pages 分支
# 如果分支不存在，创建它
git checkout -b gh-pages

# 3. 删除除 site 目录外的所有文件（保留 .gitignore 等重要文件）
# 注意：请小心操作此步骤
rm -rf !(.git|.gitignore|site)

# 4. 将 site 目录下的所有文件复制到当前目录
cp -r site/* .

# 5. 删除 site 目录
rm -rf site

# 6. 提交更改
git add .
git commit -m "Deploy documentation"

# 7. 推送到 GitHub
git push origin gh-pages

# 8. 切换回主分支
git checkout main
```

### 4.3 方式三：使用 GitHub Actions 自动部署

GitHub Actions 可以实现自动部署，每当您推送代码到主分支时，自动构建并部署文档。

1. 在项目根目录下创建 `.github/workflows` 目录：

```bash
mkdir -p .github/workflows
```

2. 创建 `.github/workflows/deploy.yml` 文件，添加以下内容：

```yaml
name: Deploy Documentation

on:
  push:
    branches: [ main ]  # 主分支名称，根据您的实际情况调整
  pull_request:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install mkdocs mkdocs-material  # 根据您使用的主题调整
      - name: Build and deploy
        run: mkdocs gh-deploy --force
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## 5. 配置 GitHub Pages

1. 登录 GitHub，进入您的仓库
2. 点击 "Settings"（设置）选项卡
3. 在左侧菜单中点击 "Pages"
4. 在 "Source" 部分：
   - 选择 "Deploy from a branch"
   - 选择分支：`gh-pages`
   - 选择目录：`/ (root)`
   - 点击 "Save"

## 6. 访问您的网站

部署完成后，您的网站将可以通过以下 URL 访问：
- 个人主页：`https://yourusername.github.io`
- 项目主页：`https://yourusername.github.io/your-repository-name`

**注意：** 首次部署可能需要几分钟时间，GitHub Pages 需要时间构建和发布您的网站。

## 7. 常见问题及解决方案

### 7.1 部署后网站无法访问

- 检查 GitHub Pages 配置是否正确
- 检查部署分支是否包含正确的构建文件
- 等待几分钟后再次尝试访问
- 查看 GitHub Actions 日志（如果使用自动部署）

### 7.2 网站样式丢失

- 检查 `mkdocs.yml` 中的 `site_url` 配置是否正确
- 确保所有静态资源路径正确
- 检查浏览器控制台的网络请求，查看是否有资源加载失败

### 7.3 本地构建正常，部署后显示 404

- 检查 `use_directory_urls` 配置是否正确（默认值为 `true`）
- 确保 `index.html` 文件存在于部署分支的根目录
- 检查 GitHub Pages 配置中的分支和目录设置

## 8. 本项目特殊配置说明

### 8.1 自定义主题配置

本项目使用自定义主题 `custom_theme`，部署时需要注意：

- 确保 `custom_theme` 目录中的所有文件都已正确提交到 Git 仓库
- 检查 `mkdocs.yml` 中的主题配置：

```yaml
theme:
  name: null
  custom_dir: custom_theme
```

### 8.2 静态资源处理

本项目的静态资源（如图标）存储在 `docs/assets` 目录下，部署时会自动复制到构建输出中。

### 8.3 插件配置

本项目使用了一些 Markdown 扩展和插件，部署时确保这些插件已正确安装：

```bash
pip install mkdocs-pymdownx-material-extras pymdown-extensions
```

## 9. 定期更新部署

每当您更新了文档内容或配置时，需要重新部署网站：

```bash
# 使用 mkdocs gh-deploy 命令重新部署
mkdocs gh-deploy
```

如果使用 GitHub Actions 自动部署，只需将更改推送到主分支即可自动触发部署。

## 10. 高级配置

### 10.1 自定义域名

如果您想使用自定义域名访问网站：

1. 在域名注册商处配置 CNAME 记录，指向 `yourusername.github.io`
2. 在 GitHub Pages 配置中添加自定义域名
3. 在项目根目录下创建 `CNAME` 文件，内容为您的自定义域名

### 10.2 HTTPS 配置

GitHub Pages 自动为您的网站提供 HTTPS 支持，无需额外配置。

---

**部署完成！** 祝您使用愉快！

如果您遇到任何问题，请参考 GitHub Pages 官方文档或 MkDocs 官方文档。
